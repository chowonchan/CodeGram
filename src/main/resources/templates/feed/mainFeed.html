<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CODEGRAM</title>

  <link rel="stylesheet" th:href="@{/css/mainfeed.css}">
  <link rel="stylesheet" th:href="@{/css/header.css}">
  <link rel="stylesheet" th:href="@{/css/footer.css}">
  <link rel="stylesheet" th:href="@{/css/feed/feedSlide.css}">
  <link rel="stylesheet" th:href="@{/css/feed/memberRecommend.css}">
  <link rel="stylesheet" th:href="@{/css/feed/feedStory.css}">

</head>

<body>

  <!-- Story Section Header -->
  <header class="stories-section">
    <div class="stories-container" th:if="${not #lists.isEmpty(stories)}">
      <!-- Story Items -->
      <div th:each="story : ${stories}" class="story-item" th:data-story-id="${story.storyNo}">
        <div class="story-wrapper" th:classappend="${board.storyCheck ? 'viewed' : ''}"> 
          <!-- 윗 부분 th:classappend="${story.viewed} ? 'viewed' : '' 에서 story.viewed 고쳐야됨. 
                읽었는지 확인하는건데 확인할 필요가 없어보이긴함. 
                왜냐하면 값이 들어가 있으면 이미 읽었다는 것. 그렇다면 값이 있는지 없는지 체크가 되야.
                그렇다면? storyCheck를 만들어야 겠다. ㅇㅇㅇ
                다른 check는 solid를 주면 check된거고 regular를 주면 check가 안된것.
                스토리는 뒤에 불이 꺼져있으면 check된거고 불이 켜져있으면 check가 안된것.
                -->
          <div class="story-border">
            <img th:src="${member.profileImg != null} ? 
                         ${member.profileImg} : '/images/default-profile.png'" 
                 class="story-profile-image">
          </div>
        </div>
        <span th:text="${member.memberNickname}" class="story-username">닉네임</span>
      </div>
    </div>

    <!-- Empty State -->
    <div th:if="${#lists.isEmpty(stories)}" class="empty-stories">
      <p>새로운 스토리가 없습니다</p>
    </div>

    <!-- Navigation Buttons (6개 이상일 경우) -->
    <button class="nav-button prev" th:if="${#lists.size(stories) > 6}" onclick="navigateStories('prev')"
      aria-label="이전 스토리">
      <span class="nav-icon">←</span>
    </button>
    <button class="nav-button next" th:if="${#lists.size(stories) > 6}" onclick="navigateStories('next')"
      aria-label="다음 스토리">
      <span class="nav-icon">→</span>
    </button>
  </header>



  
  <!-- 사이드바 조각 -->
  <div class="header-container" th:replace="~{fragments/header :: header}"></div>

  <main>
    <div class="main-container">
      <!-- 피드 영역 - 무한 스크롤을 위한 container class 추가 -->
      <div class="feed-margin infinite-scroll-container">
        <!-- 게시물들이 추가될 wrapper -->
        <div class="feed infinite-scroll-wrapper">
          <!-- 개별 게시물 템플릿 -->
          <template id="post-template">
            <article class="board-article">
              <div class="post">
                <!-- 기존 게시물 구조 유지 -->
                <div class="post-header post-header-padding">...</div>
                <div class="post-images-container">...</div>
                <div class="important-box">...</div>
              </div>
            </article>
          </template>

          <!-- 로딩 인디케이터 -->
          <div class="loading-indicator" style="display: none;">
            <div class="spinner"></div>
            <p>게시물을 불러오는 중...</p>
          </div>
        </div>
      </div>

      <!-- 회원 추천 섹션 -->
      <section th:replace="~{fragments/feed/memberRecommend :: memberRecommend}"></section>
    </div>
  </main>

  <!-- 푸터 -->
  <div th:replace="~{fragments/footer :: footer}"></div>

  <!-- 스크립트 -->
  <script src="/js/feed/feedStory.js"></script>
  <script src="/js/feed/feedSlide.js"></script>
  <script src="/js/feed/mainfeedInfiniteScroll.js"></script>
  <script src="/js/feed/mainfeed.js"></script>
</body>

</html>